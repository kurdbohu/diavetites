<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8">
  <title>Énekek kivetítése</title>
  <link rel="stylesheet" href="css/index.css">
  <script type="text/javascript" src="js/jquery.1.12.4.min.js"></script>
  <script type="text/javascript" src="js/jszip.min.js"></script>
  <script type="text/javascript" src="js/pptxgen.min.js"></script>
  <script type="text/javascript" src="js/dia_keszitese.js"></script>
  <script type="text/javascript" src="js/dia_muveletek.js"></script>
  <script type="text/javascript" src="js/dalszovegek.js"></script>
  <script type="text/javascript" src="js/diasor_megjelenitese.js"></script>
  <script type="text/javascript" src="js/diasor_focim.js"></script>
  <script type="text/javascript" src="js/diasor_dalszoveg.js"></script>
  <script type="text/javascript" src="js/diasor_cim.js"></script>
  <script type="text/javascript" src="js/diasor_igehely_cimmel.js"></script>
  <script type="text/javascript" src="js/diasor_musorszunet.js"></script>
  <script type="text/javascript" src="js/diasor_urvacsora.js"></script>
 </head>
 <body>

<h1>Kivetítés összeállítása</h1>
<table>
 <!-- Műsorszünet -->
 <tr>
  <td><button onclick="dia_keszitese_specialisan('musorszunet');">+</button></td>
  <td>műsorszünet címlap</td>
 </tr>
 
 <!-- Istentisztelet + dátum -->
 <tr>
  <td><button onclick="dia_keszitese_specialisan('focim');">+</button></td>
  <td>
   <input id="cimoldal_szoveg" type="text" value="ISTENTISZTELET">
  </td>
 </tr>
 <tr>
  <td></td>
  <td>
   <input id="focim_datum" type="date">
  </td>
 </tr>
 
 <!-- Cím: Bemenetel -->
 <tr>
  <td><button onclick="dia_keszitese_cim('BEMENETEL');">+</button></td>
  <td>BEMENETEL</td>
 </tr>
 
 <!-- Cím: Köszöntés-->
 <tr>
  <td><button onclick="dia_keszitese_cim('KÖSZÖNTÉS');">+</button></td>
  <td>KÖSZÖNTÉS</td>
 </tr>
 
 <!-- Dalszöveg: Ifiének -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('ifienek_valasztasa_1');">+</button></td>
  <td>
   <select id="ifienek_valasztasa_1" class="ifienek_valasztasa"></select> ifiének
  </td>
 </tr>
 
 <!-- Dalszöveg: Ifiének -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('ifienek_valasztasa_2');">+</button></td>
  <td>
   <select id="ifienek_valasztasa_2" class="ifienek_valasztasa"></select> ifiének
  </td>
 </tr>
 
 <!-- Igevers -->
 <tr>
  <td><button onclick="dia_keszitese_sajat_cim('igehely');">+</button></td>
  <td><input id="igehely" type="text" placeholder="Zsolt 78:1-4,17-31"> igehely</td>
 </tr>
 
 <!-- Dalszöveg: Ifiének -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('ifienek_valasztasa_3');">+</button></td>
  <td>
   <select id="ifienek_valasztasa_3" class="ifienek_valasztasa"></select> ifiének
  </td>
 </tr>
 
 <!-- Cím: Pásztori imádság -->
 <tr>
  <td><button onclick="dia_keszitese_cim('PÁSZTORI IMÁDSÁG');">+</button></td>
  <td>PÁSZTORI IMÁDSÁG</td>
 </tr>
 
 <!-- Cím: Igehirdetés és válaszadás -->
 <tr>
  <td><button onclick="dia_keszitese_cim('IGEHIRDETÉS ÉS VÁLASZASDÁS');">+</button></td>
  <td>IGEHIRDETÉS ÉS VÁLASZASDÁS</td>
 </tr>
 
 <!-- Dalszöveg: Ifiének -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('ifienek_valasztasa_4');">+</button></td>
  <td>
   <select id="ifienek_valasztasa_4" class="ifienek_valasztasa"></select> ifiének
  </td>
 </tr>
 
 <!-- Cím: Lekció + ige -->
 <tr>
  <td><button onclick="dia_keszitese_ige_cimmel('LEKCIÓ', 'lekcio');">+</button></td>
  <td>LEKCIÓ</td>
 </tr>
 <tr>
  <td></td>
  <td><input id="lekcio" type="text" placeholder="Ézs 55,1-11"></td>
 </tr>
 
 <!-- Cím: Evangélium + ige -->
 <tr>
  <td><button onclick="dia_keszitese_ige_cimmel('EVANGÉLIUM', 'evangelium');">+</button></td>
  <td>EVANGÉLIUM</td>
 </tr>
 <tr>
  <td></td>
  <td><input id="evangelium" type="text" placeholder="Lk 11,5-13"></td>
 </tr>
 
 <!-- Dalszöveg: Dicséretek -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('dicseret_valasztasa_1');">+</button></td>
  <td><select id="dicseret_valasztasa_1" class="dicseret_valasztasa"></select> dicséret</td>
 </tr>
 
 <!-- Cím: Textus + ige -->
 <tr>
  <td><button onclick="dia_keszitese_ige_cimmel('TEXTUS', 'textus');">+</button></td>
  <td>TEXTUS</td>
 </tr>
 <tr>
  <td></td>
  <td><input id="textus" type="text" placeholder="1Pt 5,6-7"></td>
 </tr>
 
 <!-- Cím: Igehirdetés -->
 <tr>
  <td><button onclick="dia_keszitese_cim('IGEHIRDETÉS');">+</button></td>
  <td>IGEHIRDETÉS</td>
 </tr>
 
 <!-- Dalszöveg: Dicséretek -->
 <tr>
  <td><button onclick="dia_keszitese_dalszoveg('dicseret_valasztasa_2');">+</button></td>
  <td><select id="dicseret_valasztasa_2" class="dicseret_valasztasa"></select> dicséret</td>
 </tr>
 

 <!-- ================================
              SPECIÁLIS RÉSZEK
      ================================ -->
 
 <!-- Úrvacsorai liturgia -->
 <tr>
  <td><button onclick="dia_keszitese_specialisan('urvacsora');">+</button></td>
  <td>úrvacsorai liturgia</td>
 </tr>
 <tr>
  <td></td>
  <td>
   <select> <!-- TODO: ének kiválasztása -->
    <option>47. Ó, hála az Úrnak</option>
   </select> ének 1 versszakkal
  </td>
 </tr>
 <tr>
  <td></td>
  <td>
   <select>
    <option>502. Az Úr szent Bárányára</option>
   </select> közbülső ének (utolsó előtti versszakig)
  </td>
 </tr>
 
 
 <!-- ================================ -->
 
 <!-- Cím: Kiküldés -->
 <tr>
  <td><button onclick="dia_keszitese_cim('KIKÜLDÉS');">+</button></td>
  <td>KIKÜLDÉS</td>
 </tr>
 
 <!-- Cím: Hirdetések -->
 <tr>
  <td><button onclick="dia_keszitese_cim('HIRDETÉSEK');">+</button></td>
  <td>HIRDETÉSEK</td>
 </tr>
 <tr>
  <td></td>
  <td>
   <textarea></textarea>
  </td>
 </tr>
 
 <!-- Áldás -->
 <tr>
  <td><button onclick="dia_keszitese_cim('ÁLDÁS');">+</button></td>
  <td>ÁLDÁS</td>
 </tr>
 
 <!-- Úrvacsorán megkezdett ének utolsó versszaka -->
 <tr>
  <td><button onclick="dia_keszitese_specialisan('urvacsora_enek_utolso_versszaka');">+</button></td>
  <td>megkezdett úrvacsorai ének utolsó versszaka</td>
 </tr>
 
</table>

<table>
 <tr valign="top">
  <td><img class="vezerlo_gomb" src="kepek/kuka.png" onclick="kijelolt_diak_torlese();"></td>
  <td><img class="vezerlo_gomb" src="kepek/mozgatas_balra.png" onclick="kijelolt_dia_mozgatasa_balra();"></td>
  <td><img class="vezerlo_gomb" src="kepek/mozgatas_jobbra.png" onclick="kijelolt_dia_mozgatasa_jobbra();"></td>
  <td><div id="diameret_100" class="vezerlo_gomb" onclick="diameretek_beallitasa(100);"><img src="kepek/doboz.png" style="height:12px; width:12px;"></div></td>
  <td><div id="diameret_150" class="vezerlo_gomb" onclick="diameretek_beallitasa(150);"><img src="kepek/doboz.png" style="height:18px; width:18px;"></div></td>
  <td><div id="diameret_200" class="vezerlo_gomb" onclick="diameretek_beallitasa(200);"><img src="kepek/doboz.png" style="height:26px; width:26px;"></div></td>
  <td><div id="diameret_300" class="vezerlo_gomb" onclick="diameretek_beallitasa(300);"><img src="kepek/doboz.png" style="height:32px; width:32px;"></div></td>
  <td><div id="diameret_500" class="vezerlo_gomb" onclick="diameretek_beallitasa(500);"><img src="kepek/doboz.png" style="height:40px; width:40px;"></div></td>
 </tr>
</table>

<div id="diasor"></div>

<script type="text/javascript">
// PPT generátor: https://products.aspose.app/pdf/hu/conversion/ppt-to-txt

// Vasárnap beállítása alap dátumnak:
var vasarnap = new Date();
if (vasarnap.getDay() > 0) vasarnap.setDate(vasarnap.getDate() - vasarnap.getDay() + 7);
document.getElementById('focim_datum').valueAsDate = vasarnap;

// TODO: a dián majd ki kell írni a hónap nevét
var honapok_nevei = ["január", "február", "március", "április", "május", "június", 
                     "július", "augusztus", "szeptember", "október", "november", "december"];

var diasor = [];
var kurzor = 0;

diameretek_beallitasa(200);
dallista_betoltese();


function ppt_keszitese()
{
    // PPTX generátor dokumentációja: https://gitbrent.github.io/PptxGenJS/docs/api-text
    // PPTX PPT-be konvertálása: https://cloudconvert.com/pptx-to-ppt
    // beállítások:
    var szelesseg = 10;         // 25,4 cm = 10 inch
    var magassag  = 5.625;      // 15,87 cm = 6,2480314960629921259842519685039 inch --> 5,625 inch (16:9)

    let pptx = new PptxGenJS();
    pptx.defineLayout(
    {
        name   : 'szélesvásznú',
        width  : szelesseg,
        height : magassag
    });
    pptx.layout = 'szélesvásznú';

    // diák hozzáadása:
    // let kezdolap = pptx.addSlide("kezdőlap")     // localhost-on a chrome nem engedi
    //                    .addImage({path: "kepek/kezdolap.png", x: 0, y: 0, w: '100%', h: '100%'});
    let cimlap = pptx.addSlide("címlap")
                     .addText(
                     [
                        {text: "ISTENTISZTELET", options: {align:'center', color: "#FFFFFF", fontSize:44, breakLine: true}},
                        {text: "2021. augusztus 1.", options: {align:'center', color: "#FFFFFF", fontSize:32, breakLine: false}}
                     ],
                     {
                        x: 0, y: 0, w: '100%', h: '100%',
                        fill: { color: "#008000" }
                     });

    // prezi mentése
    pptx.writeFile({fileName: "elso_prezi.pptx"});
}
</script>


 </body>
</html>